{"version":3,"file":"v-tabs.js","sources":["uni_modules/v-tabs/components/v-tabs/v-tabs.vue","../../../Downloads/HBuilderX.2.7.14.20200618.full/HBuilderX/plugins/uniapp-cli-vite/uniComponent:/QzovVXNlcnMvYWRtaW4vRGVza3RvcC_nroDljZXorrDpobnnm64v566A5Y2V6K6wL3VuaV9tb2R1bGVzL3YtdGFicy9jb21wb25lbnRzL3YtdGFicy92LXRhYnMudnVl"],"sourcesContent":["<template>\r\n  <view class=\"v-tabs\">\r\n    <scroll-view\r\n      :id=\"getDomId\"\r\n      :scroll-x=\"scroll\"\r\n      :scroll-left=\"scroll ? scrollLeft : 0\"\r\n      :scroll-with-animation=\"scroll\"\r\n      :style=\"{ position: fixed ? 'fixed' : 'relative', zIndex, width: '100%' }\">\r\n      <view\r\n        class=\"v-tabs__container\"\r\n        :style=\"{\r\n          display: scroll ? 'inline-flex' : 'flex',\r\n          whiteSpace: scroll ? 'nowrap' : 'normal',\r\n          background: bgColor,\r\n          height,\r\n          padding\r\n        }\">\r\n        <view\r\n          :class=\"['v-tabs__container-item', { disabled: !!v.disabled }, { active: current == i }]\"\r\n          v-for=\"(v, i) in tabs\"\r\n          :key=\"i\"\r\n          :style=\"{\r\n            color: current == i ? activeColor : color,\r\n            fontSize: current == i ? fontSize : fontSize,\r\n            fontWeight: bold && current == i ? 'bold' : '',\r\n            justifyContent: !scroll ? 'center' : '',\r\n            flex: scroll ? '' : 1,\r\n            padding: paddingItem\r\n          }\"\r\n          @click=\"change(i)\">\r\n          <slot :row=\"v\" :index=\"i\">{{ field ? v[field] : v }}</slot>\r\n        </view>\r\n        <template v-if=\"!!tabs.length\">\r\n          <view\r\n            v-if=\"!pills\"\r\n            :class=\"['v-tabs__container-line', { animation: lineAnimation }]\"\r\n            :style=\"{\r\n              background: lineColor,\r\n              width: lineWidth + 'px',\r\n              height: lineHeight,\r\n              borderRadius: lineRadius,\r\n              transform: `translate3d(${lineLeft}px, 0, 0)`\r\n            }\" />\r\n          <view\r\n            v-else\r\n            :class=\"['v-tabs__container-pills', { animation: lineAnimation }]\"\r\n            :style=\"{\r\n              background: pillsColor,\r\n              borderRadius: pillsBorderRadius,\r\n              width: currentWidth + 'px',\r\n              transform: `translate3d(${pillsLeft}px, 0, 0)`,\r\n              height\r\n            }\" />\r\n        </template>\r\n      </view>\r\n    </scroll-view>\r\n    <!-- fixed 的站位高度 -->\r\n    <view class=\"v-tabs__placeholder\" :style=\"{ height: fixed ? height : '0', padding }\"></view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { startMicroTask, throttle } from './utils'\r\nimport props from './props'\r\n/**\r\n * v-tabs\r\n * @property {Number} value 选中的下标\r\n * @property {Array} tabs tabs 列表\r\n * @property {String} bgColor = '#fff' 背景颜色\r\n * @property {String} color = '#333' 默认颜色\r\n * @property {String} activeColor = '#2979ff' 选中文字颜色\r\n * @property {String} fontSize = '28rpx' 默认文字大小\r\n * @property {String} activeFontSize = '28rpx' 选中文字大小\r\n * @property {Boolean} bold = [true | false] 选中文字是否加粗\r\n * @property {Boolean} scroll = [true | false] 是否滚动\r\n * @property {String} height = '60rpx' tab 的高度\r\n * @property {String} lineHeight = '10rpx' 下划线的高度\r\n * @property {String} lineColor = '#2979ff' 下划线的颜色\r\n * @property {Number} lineScale = 0.5 下划线的宽度缩放比例\r\n * @property {String} lineRadius = '10rpx' 下划线圆角\r\n * @property {Boolean} pills = [true | false] 是否胶囊样式\r\n * @property {String} pillsColor = '#2979ff' 胶囊背景色\r\n * @property {String} pillsBorderRadius = '10rpx' 胶囊圆角大小\r\n * @property {String} field 如果是对象，显示的键名\r\n * @property {Boolean} fixed = [true | false] 是否固定\r\n * @property {String} paddingItem = '0 22rpx' 选项的边距\r\n * @property {Boolean} lineAnimation = [true | false] 下划线是否有动画\r\n * @property {Number} zIndex = 1993 默认层级\r\n *\r\n * @event {Function(current)} change 改变标签触发\r\n */\r\nexport default {\r\n  name: 'VTabs',\r\n  props,\r\n  // #ifdef VUE3\r\n  emits: ['update:modelValue', 'change'],\r\n  // #endif\r\n  data() {\r\n    return {\r\n      lineWidth: 30,\r\n      currentWidth: 0, // 当前选项的宽度\r\n      lineLeft: 0, // 滑块距离左侧的位置\r\n      pillsLeft: 0, // 胶囊距离左侧的位置\r\n      scrollLeft: 0, // 距离左边的位置\r\n      container: { width: 0, height: 0, left: 0, right: 0 }, // 容器的宽高，左右距离\r\n      current: 0, // 当前选中项\r\n      scrollWidth: 0 // 可以滚动的宽度\r\n    }\r\n  },\r\n  computed: {\r\n    getDomId() {\r\n      const len = 16\r\n      const $chars = 'ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678' /****默认去掉了容易混淆的字符oOLl,9gq,Vv,Uu,I1****/\r\n      const maxPos = $chars.length\r\n      let pwd = ''\r\n      for (let i = 0; i < len; i++) {\r\n        pwd += $chars.charAt(Math.floor(Math.random() * maxPos))\r\n      }\r\n      return `xfjpeter_${pwd}`\r\n    }\r\n  },\r\n  watch: {\r\n    // #ifdef VUE3\r\n    modelValue: {\r\n    // #endif\r\n    // #ifdef VUE2\r\n    value: {\r\n    // #endif\r\n      immediate: true,\r\n      handler(newVal) {\r\n        this.current = newVal > -1 && newVal < this.tabs.length ? newVal : 0\r\n        this.$nextTick(this.update)\r\n      }\r\n    }\r\n  },\r\n  methods: {\r\n    // 切换事件\r\n    change: throttle(function(index) {\r\n      const isDisabled = !!this.tabs[index].disabled\r\n      if (this.current !== index && !isDisabled) {\r\n        this.current = index\r\n        // #ifdef VUE3\r\n        this.$emit('update:modelValue', index)\r\n        // #endif\r\n        // #ifdef VUE2\r\n        this.$emit('input', index)\r\n        // #endif\n        this.$emit('change', index)\r\n      }\r\n    }, 300),\r\n    createQueryHandler() {\r\n      let query\r\n      // #ifndef MP-ALIPAY\r\n      query = uni.createSelectorQuery().in(this)\r\n      // #endif\r\n      // #ifdef MP-ALIPAY\r\n      query = uni.createSelectorQuery()\r\n      // #endif\r\n\r\n      return query\r\n    },\r\n    update() {\r\n      const _this = this\r\n      startMicroTask(() => {\r\n        // 没有列表的时候，不执行\r\n        if (!this.tabs.length) return\r\n        _this\r\n          .createQueryHandler()\r\n          .select(`#${this.getDomId}`)\r\n          .boundingClientRect(data => {\r\n            const { width, height, left, right } = data || {}\r\n            // 获取容器的相关属性\r\n            this.container = { width, height, left, right: right - width }\r\n            _this.calcScrollWidth()\r\n            _this.setScrollLeft()\r\n            _this.setLine()\r\n          })\r\n          .exec()\r\n      })\r\n    },\r\n    // 计算可以滚动的宽度\r\n    calcScrollWidth(callback) {\r\n      const view = this.createQueryHandler().select(`#${this.getDomId}`)\r\n      view.fields({ scrollOffset: true })\r\n      view\r\n        .scrollOffset(res => {\r\n          if (typeof callback === 'function') {\r\n            callback(res)\r\n          } else {\r\n            // 获取滚动条的宽度\r\n            this.scrollWidth = res.scrollWidth\r\n          }\r\n        })\r\n        .exec()\r\n    },\r\n    // 设置滚动条滚动的进度\r\n    setScrollLeft() {\r\n      this.calcScrollWidth(res => {\r\n        // 动态读取 scrollLeft\r\n        let scrollLeft = res.scrollLeft\r\n        this.createQueryHandler()\r\n          .select(`#${this.getDomId} .v-tabs__container-item.active`)\r\n          .boundingClientRect(data => {\r\n            if (!data) return\r\n            // 除开当前选项外容器的一半宽度\r\n            let curHalfWidth = (this.container.width - data.width) / 2\r\n            let scrollDiff = this.scrollWidth - this.container.width\r\n            // 在原有滚动条的基础上 + (当前元素距离左侧的距离 - 计算的一半宽度) - 容器的外边距之类的\r\n            scrollLeft += data.left - curHalfWidth - this.container.left\r\n            // 已经滚动在左侧了\r\n            if (scrollLeft < 0) scrollLeft = 0\r\n            // 已经超出右侧了\r\n            else if (scrollLeft > scrollDiff) scrollLeft = scrollDiff\r\n            this.scrollLeft = scrollLeft\r\n          })\r\n          .exec()\r\n      })\r\n    },\r\n    setLine() {\r\n      this.calcScrollWidth(res => {\r\n        const scrollLeft = res.scrollLeft\r\n        this.createQueryHandler()\r\n          .select(`#${this.getDomId} .v-tabs__container-item.active`)\r\n          .boundingClientRect(data => {\r\n            if (!data) return\r\n            if (this.pills) {\r\n              this.currentWidth = data.width\r\n              this.pillsLeft = scrollLeft + data.left - this.container.left\r\n            } else {\r\n              this.lineWidth = data.width * this.lineScale\r\n              this.lineLeft = scrollLeft + data.left + (data.width - data.width * this.lineScale) / 2 - this.container.left\r\n            }\r\n          })\r\n          .exec()\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.v-tabs {\r\n  width: 100%;\r\n  box-sizing: border-box;\r\n  overflow: hidden;\r\n\r\n  /* #ifdef H5 */\r\n  ::-webkit-scrollbar {\r\n    display: none;\r\n  }\r\n  /* #endif */\r\n\r\n  &__container {\r\n    min-width: 100%;\r\n    position: relative;\r\n    display: inline-flex;\r\n    align-items: center;\r\n    white-space: nowrap;\r\n    overflow: hidden;\r\n\r\n    &-item {\r\n      flex-shrink: 0;\r\n      display: flex;\r\n      align-items: center;\r\n      height: 100%;\r\n      position: relative;\r\n      z-index: 10;\r\n      transition: all 0.3s;\r\n      white-space: nowrap;\r\n\r\n      &.disabled {\r\n        opacity: 0.5;\r\n        color: #999;\r\n      }\r\n    }\r\n\r\n    &-line {\r\n      position: absolute;\r\n      left: 0;\r\n      bottom: 0;\r\n    }\r\n\r\n    &-pills {\r\n      position: absolute;\r\n      z-index: 9;\r\n    }\r\n\r\n    &-line,\r\n    &-pills {\r\n      &.animation {\r\n        transition: all 0.3s linear;\r\n      }\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import Component from 'C:/Users/admin/Desktop/简单记项目/简单记/uni_modules/v-tabs/components/v-tabs/v-tabs.vue'\nwx.createComponent(Component)"],"names":["props","throttle","uni","startMicroTask"],"mappings":"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"}